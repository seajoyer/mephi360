{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */'use client';\n\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { useCallback, useRef, useState } from \"react\";\nimport { isFunction } from \"../helpers/fuctions\";\nimport { useEnhancedEffect } from \"./useEnhancedEffect\";\nexport function useCustomEnsuredControl({\n  value,\n  defaultValue,\n  disabled,\n  onChange: onChangeProp\n}) {\n  const isControlled = value !== undefined;\n  const [localValue, setLocalValue] = useState(defaultValue);\n  const preservedControlledValueRef = useRef();\n  useEnhancedEffect(() => {\n    preservedControlledValueRef.current = value;\n  });\n  const onChange = useCallback(nextValue => {\n    if (disabled) {\n      return;\n    }\n    if (isFunction(nextValue)) {\n      if (!isControlled) {\n        setLocalValue(prevValue => {\n          const resolvedValue = nextValue(prevValue);\n          if (onChangeProp) {\n            onChangeProp(resolvedValue);\n          }\n          return resolvedValue;\n        });\n      } else if (onChangeProp) {\n        const resolvedValue = nextValue(preservedControlledValueRef.current);\n        onChangeProp(resolvedValue);\n      }\n      return;\n    }\n    onChangeProp && onChangeProp(nextValue);\n    !isControlled && setLocalValue(nextValue);\n  }, [disabled, isControlled, onChangeProp]);\n  return [isControlled ? value : localValue, onChange];\n}\nexport function useEnsuredControl(_param) {\n  var {\n      onChange: onChangeProp,\n      disabled\n    } = _param,\n    props = _object_without_properties(_param, [\"onChange\", \"disabled\"]);\n  const [value, onChangeValue] = useCustomEnsuredControl(props);\n  const onChange = useCallback(e => {\n    if (disabled) {\n      return;\n    }\n    onChangeValue(e.target.value);\n    onChangeProp && onChangeProp(e);\n  }, [onChangeValue, onChangeProp, disabled]);\n  return [value, onChange];\n}","map":{"version":3,"names":["useCallback","useRef","useState","isFunction","useEnhancedEffect","useCustomEnsuredControl","value","defaultValue","disabled","onChange","onChangeProp","isControlled","undefined","localValue","setLocalValue","preservedControlledValueRef","current","nextValue","prevValue","resolvedValue","useEnsuredControl","_param","props","_object_without_properties","onChangeValue","e","target"],"sources":["/home/dmitry/Projects/MEPhI/MEPhI360/app/node_modules/@telegram-apps/telegram-ui/src/hooks/useEnsureControl.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\n'use client';\n\nimport { ChangeEvent, Dispatch, SetStateAction, useCallback, useRef, useState } from 'react';\n\nimport { isFunction } from 'helpers/fuctions';\nimport { useEnhancedEffect } from 'hooks/useEnhancedEffect';\n\nexport interface UseCustomEnsuredControlProps<V> {\n  value?: V;\n  defaultValue: V;\n  disabled?: boolean | undefined;\n  onChange?(this: void, v: V): any;\n}\n\nexport function useCustomEnsuredControl<V = any>({\n  value,\n  defaultValue,\n  disabled,\n  onChange: onChangeProp,\n}: UseCustomEnsuredControlProps<V>): [V, Dispatch<SetStateAction<V>>] {\n  const isControlled = value !== undefined;\n  const [localValue, setLocalValue] = useState(defaultValue);\n  const preservedControlledValueRef = useRef<V>();\n\n  useEnhancedEffect(() => {\n    preservedControlledValueRef.current = value;\n  });\n\n  const onChange = useCallback((nextValue: V | ((prevValue: any) => V)) => {\n    if (disabled) {\n      return;\n    }\n\n    if (isFunction(nextValue)) {\n      if (!isControlled) {\n        setLocalValue((prevValue) => {\n          const resolvedValue = nextValue(prevValue);\n          if (onChangeProp) {\n            onChangeProp(resolvedValue);\n          }\n          return resolvedValue;\n        });\n      } else if (onChangeProp) {\n        const resolvedValue = nextValue(preservedControlledValueRef.current);\n        onChangeProp(resolvedValue);\n      }\n\n      return;\n    }\n\n    onChangeProp && onChangeProp(nextValue);\n    !isControlled && setLocalValue(nextValue);\n  }, [disabled, isControlled, onChangeProp]);\n\n  return [isControlled ? value : localValue, onChange];\n}\n\nexport interface UseEnsuredControlProps<V, E extends ChangeEvent<any>> {\n  value?: V;\n  defaultValue: V;\n  disabled?: boolean | undefined;\n  onChange?(this: void, e: E): any;\n}\n\nexport function useEnsuredControl<V, E extends ChangeEvent<any>>({\n  onChange: onChangeProp,\n  disabled,\n  ...props\n}: UseEnsuredControlProps<V, E>): [V, (e: E) => any] {\n  const [value, onChangeValue] = useCustomEnsuredControl(props);\n\n  const onChange = useCallback(\n    (e: E) => {\n      if (disabled) {\n        return;\n      }\n\n      onChangeValue(e.target.value);\n      onChangeProp && onChangeProp(e);\n    },\n    [onChangeValue, onChangeProp, disabled],\n  );\n\n  return [value, onChange];\n}\n"],"mappings":"AAAA,uDAEA;;;AAEA,SAAgDA,WAAW,EAAEC,MAAM,EAAEC,QAAQ,QAAQ;AAErF,SAASC,UAAU,QAAQ;AAC3B,SAASC,iBAAiB,QAAQ;AASlC,OAAO,SAASC,wBAAiC;EAC/CC,KAAK;EACLC,YAAY;EACZC,QAAQ;EACRC,QAAA,EAAUC;AAAY,CACU;EAChC,MAAMC,YAAA,GAAeL,KAAA,KAAUM,SAAA;EAC/B,MAAM,CAACC,UAAA,EAAYC,aAAA,CAAc,GAAGZ,QAAA,CAASK,YAAA;EAC7C,MAAMQ,2BAAA,GAA8Bd,MAAA;EAEpCG,iBAAA,CAAkB;IAChBW,2BAAA,CAA4BC,OAAO,GAAGV,KAAA;EACxC;EAEA,MAAMG,QAAA,GAAWT,WAAA,CAAaiB,SAAA;IAC5B,IAAIT,QAAA,EAAU;MACZ;IACF;IAEA,IAAIL,UAAA,CAAWc,SAAA,GAAY;MACzB,IAAI,CAACN,YAAA,EAAc;QACjBG,aAAA,CAAeI,SAAA;UACb,MAAMC,aAAA,GAAgBF,SAAA,CAAUC,SAAA;UAChC,IAAIR,YAAA,EAAc;YAChBA,YAAA,CAAaS,aAAA;UACf;UACA,OAAOA,aAAA;QACT;MACF,OAAO,IAAIT,YAAA,EAAc;QACvB,MAAMS,aAAA,GAAgBF,SAAA,CAAUF,2BAAA,CAA4BC,OAAO;QACnEN,YAAA,CAAaS,aAAA;MACf;MAEA;IACF;IAEAT,YAAA,IAAgBA,YAAA,CAAaO,SAAA;IAC7B,CAACN,YAAA,IAAgBG,aAAA,CAAcG,SAAA;EACjC,GAAG,CAACT,QAAA,EAAUG,YAAA,EAAcD,YAAA,CAAa;EAEzC,OAAO,CAACC,YAAA,GAAeL,KAAA,GAAQO,UAAA,EAAYJ,QAAA,CAAS;AACtD;AASA,OAAO,SAASW,kBAAiDC,MAAA;MAAA;MAC/DZ,QAAA,EAAUC,YAAY;MACtBF;IAAQ,CAEqB,GAJkCa,MAAA;IAG5DC,KAAA,GAAAC,0BAAA,CAH4DF,MAAA,GAC/D,YACA,W;EAGA,MAAM,CAACf,KAAA,EAAOkB,aAAA,CAAc,GAAGnB,uBAAA,CAAwBiB,KAAA;EAEvD,MAAMb,QAAA,GAAWT,WAAA,CACdyB,CAAA;IACC,IAAIjB,QAAA,EAAU;MACZ;IACF;IAEAgB,aAAA,CAAcC,CAAA,CAAEC,MAAM,CAACpB,KAAK;IAC5BI,YAAA,IAAgBA,YAAA,CAAae,CAAA;EAC/B,GACA,CAACD,aAAA,EAAed,YAAA,EAAcF,QAAA,CAAS;EAGzC,OAAO,CAACF,KAAA,EAAOG,QAAA,CAAS;AAC1B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}