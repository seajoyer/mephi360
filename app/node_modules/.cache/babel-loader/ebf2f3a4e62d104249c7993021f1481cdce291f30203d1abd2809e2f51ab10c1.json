{"ast":null,"code":"'use client';\n\nimport { useMemo, useState } from \"react\";\nimport { useTimeout } from \"../../../../../../hooks/useTimeout\";\nconst RIPPLE_DELAY = 70;\nconst WAVE_LIVE = 225;\nexport const useRipple = () => {\n  const [clicks, setClicks] = useState([]);\n  const pointerDelayTimers = useMemo(() => new Map(), []);\n  const clearClicks = useTimeout(() => setClicks([]), WAVE_LIVE);\n  function addClick(x, y, pointerId) {\n    const dateNow = Date.now();\n    const filteredClicks = clicks.filter(click => click.date + WAVE_LIVE > dateNow);\n    setClicks([...filteredClicks, {\n      x,\n      y,\n      date: dateNow,\n      pointerId\n    }]);\n    clearClicks.set();\n    pointerDelayTimers.delete(pointerId);\n  }\n  const onPointerDown = e => {\n    const {\n      top,\n      left\n    } = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - (left !== null && left !== void 0 ? left : 0);\n    const y = e.clientY - (top !== null && top !== void 0 ? top : 0);\n    pointerDelayTimers.set(e.pointerId, setTimeout(() => addClick(x, y, e.pointerId), RIPPLE_DELAY));\n  };\n  const onPointerCancel = e => {\n    const timer = pointerDelayTimers.get(e.pointerId);\n    clearTimeout(timer);\n    pointerDelayTimers.delete(e.pointerId);\n  };\n  return {\n    clicks,\n    onPointerDown,\n    onPointerCancel\n  };\n};","map":{"version":3,"names":["useMemo","useState","useTimeout","RIPPLE_DELAY","WAVE_LIVE","useRipple","clicks","setClicks","pointerDelayTimers","Map","clearClicks","addClick","x","y","pointerId","dateNow","Date","now","filteredClicks","filter","click","date","set","delete","onPointerDown","e","top","left","currentTarget","getBoundingClientRect","clientX","clientY","setTimeout","onPointerCancel","timer","get","clearTimeout"],"sources":["/home/dmitry/Projects/MEPhI/MEPhI360/app/node_modules/@telegram-apps/telegram-ui/src/components/Service/Tappable/components/Ripple/hooks/useRipple.ts"],"sourcesContent":["'use client';\n\nimport { PointerEventHandler, useMemo, useState } from 'react';\n\nimport { useTimeout } from 'hooks/useTimeout';\n\nimport { Wave } from '../types/Wave';\n\nconst RIPPLE_DELAY = 70;\nconst WAVE_LIVE = 225;\n\nexport const useRipple = () => {\n  const [clicks, setClicks] = useState<Wave[]>([]);\n\n  const pointerDelayTimers = useMemo(\n    () => new Map<number, ReturnType<typeof setTimeout>>(),\n    [],\n  );\n\n  const clearClicks = useTimeout(() => setClicks([]), WAVE_LIVE);\n\n  function addClick(x: number, y: number, pointerId: number) {\n    const dateNow = Date.now();\n    const filteredClicks = clicks.filter((click) => click.date + WAVE_LIVE > dateNow);\n\n    setClicks([\n      ...filteredClicks,\n      {\n        x,\n        y,\n        date: dateNow,\n        pointerId,\n      },\n    ]);\n\n    clearClicks.set();\n    pointerDelayTimers.delete(pointerId);\n  }\n\n  const onPointerDown: PointerEventHandler<HTMLSpanElement> = (e) => {\n    const { top, left } = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - (left ?? 0);\n    const y = e.clientY - (top ?? 0);\n\n    pointerDelayTimers.set(\n      e.pointerId,\n      setTimeout(() => addClick(x, y, e.pointerId), RIPPLE_DELAY),\n    );\n  };\n\n  const onPointerCancel: PointerEventHandler<HTMLSpanElement> = (e) => {\n    const timer = pointerDelayTimers.get(e.pointerId);\n    clearTimeout(timer);\n    pointerDelayTimers.delete(e.pointerId);\n  };\n\n  return {\n    clicks,\n    onPointerDown,\n    onPointerCancel,\n  };\n};\n"],"mappings":"AAAA;;AAEA,SAA8BA,OAAO,EAAEC,QAAQ,QAAQ;AAEvD,SAASC,UAAU,QAAQ;AAI3B,MAAMC,YAAA,GAAe;AACrB,MAAMC,SAAA,GAAY;AAElB,OAAO,MAAMC,SAAA,GAAYA,CAAA;EACvB,MAAM,CAACC,MAAA,EAAQC,SAAA,CAAU,GAAGN,QAAA,CAAiB,EAAE;EAE/C,MAAMO,kBAAA,GAAqBR,OAAA,CACzB,MAAM,IAAIS,GAAA,IACV,EAAE;EAGJ,MAAMC,WAAA,GAAcR,UAAA,CAAW,MAAMK,SAAA,CAAU,EAAE,GAAGH,SAAA;EAEpD,SAASO,SAASC,CAAS,EAAEC,CAAS,EAAEC,SAAiB;IACvD,MAAMC,OAAA,GAAUC,IAAA,CAAKC,GAAG;IACxB,MAAMC,cAAA,GAAiBZ,MAAA,CAAOa,MAAM,CAAEC,KAAA,IAAUA,KAAA,CAAMC,IAAI,GAAGjB,SAAA,GAAYW,OAAA;IAEzER,SAAA,CAAU,C,GACLW,cAAA,EACH;MACEN,CAAA;MACAC,CAAA;MACAQ,IAAA,EAAMN,OAAA;MACND;IACF,EACD;IAEDJ,WAAA,CAAYY,GAAG;IACfd,kBAAA,CAAmBe,MAAM,CAACT,SAAA;EAC5B;EAEA,MAAMU,aAAA,GAAuDC,CAAA;IAC3D,MAAM;MAAEC,GAAG;MAAEC;IAAI,CAAE,GAAGF,CAAA,CAAEG,aAAa,CAACC,qBAAqB;IAC3D,MAAMjB,CAAA,GAAIa,CAAA,CAAEK,OAAO,IAAIH,IAAA,aAAAA,IAAA,cAAAA,IAAA,GAAQ;IAC/B,MAAMd,CAAA,GAAIY,CAAA,CAAEM,OAAO,IAAIL,GAAA,aAAAA,GAAA,cAAAA,GAAA,GAAO;IAE9BlB,kBAAA,CAAmBc,GAAG,CACpBG,CAAA,CAAEX,SAAS,EACXkB,UAAA,CAAW,MAAMrB,QAAA,CAASC,CAAA,EAAGC,CAAA,EAAGY,CAAA,CAAEX,SAAS,GAAGX,YAAA;EAElD;EAEA,MAAM8B,eAAA,GAAyDR,CAAA;IAC7D,MAAMS,KAAA,GAAQ1B,kBAAA,CAAmB2B,GAAG,CAACV,CAAA,CAAEX,SAAS;IAChDsB,YAAA,CAAaF,KAAA;IACb1B,kBAAA,CAAmBe,MAAM,CAACE,CAAA,CAAEX,SAAS;EACvC;EAEA,OAAO;IACLR,MAAA;IACAkB,aAAA;IACAS;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}