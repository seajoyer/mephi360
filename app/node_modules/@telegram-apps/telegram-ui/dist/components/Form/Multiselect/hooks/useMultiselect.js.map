{"version":3,"sources":["../../../../../src/components/Form/Multiselect/hooks/useMultiselect.ts"],"sourcesContent":["'use client';\n\nimport { ChangeEvent, useCallback, useState } from 'react';\n\nimport { isEqual } from 'helpers/equal';\nimport { useEnhancedEffect } from 'hooks/useEnhancedEffect';\n\nimport { MultiselectOption } from 'components/Form/Multiselect/types';\nimport { defaultFilterFn, FilterFn } from './helpers/filter';\nimport { transformOptions } from './helpers/transformOptions';\nimport { DEFAULT_EMPTY_TEXT, DEFAULT_SELECTED_BEHAVIOR } from './constants';\nimport { useMultiselectInput, type UseMultiselectInputProps } from './useMultiselectInput';\n\nexport interface UseMultiselectProps extends UseMultiselectInputProps {\n  /** Array of options available for selection. */\n  options?: MultiselectOption[];\n  /**\n   * Enables the creation of new options that are not in the initial list.\n   * - `true` allows adding by pressing Enter.\n   * - A `string` value also adds a button with the provided text to the dropdown for creating options.\n   */\n  creatable?: boolean | string;\n  /** Text displayed when no options are available or match the filter criteria. */\n  emptyText?: string;\n  /** Determines how selected options are treated: either hidden from the list or highlighted within it. */\n  selectedBehavior?: 'hide' | 'highlight';\n  /** Custom function to filter options based on the input value. */\n  filterFn?: false | FilterFn;\n}\n\n/**\n * Hook to manage the state and interactions of a multiselect component.\n * It encapsulates logic for option selection, input change handling, dropdown visibility, and focused option management.\n */\nexport const useMultiselect = ({\n  // Common props\n  disabled,\n\n  // Options props\n  value: valueProp,\n  defaultValue,\n  onChange,\n\n  // Input props\n  inputValue: inputValueProp = '',\n  onInputChange: onInputChangeProp,\n\n  // Dropdown props\n  creatable = false,\n  emptyText = DEFAULT_EMPTY_TEXT,\n  filterFn = defaultFilterFn,\n  selectedBehavior = DEFAULT_SELECTED_BEHAVIOR,\n  options: optionsProp = [],\n}: UseMultiselectProps) => {\n  const { value, inputValue, onInputChange, ...restMultiselectProps } = useMultiselectInput({\n    // Option props\n    value: valueProp,\n    defaultValue,\n    onChange,\n\n    // Input Props\n    inputValue: inputValueProp,\n    onInputChange: onInputChangeProp,\n\n    // Other Props\n    disabled,\n  });\n\n  const [opened, setOpened] = useState(false);\n  const [options, setOptions] = useState<MultiselectOption[]>(() =>\n    opened\n      ? transformOptions({\n        value,\n        inputValue,\n        emptyText,\n        creatable,\n        filterFn,\n        options: optionsProp,\n        selectedBehavior,\n      })\n      : [],\n  );\n\n  const [focusedOptionIndex, setFocusedOptionIndex] = useState<number | null>(0);\n  const [focusedOption, setFocusedOption] = useState<MultiselectOption | null>(null);\n\n  const handleInputChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\n    onInputChange(event);\n\n    if (!opened) {\n      return;\n    }\n\n    setOpened(true);\n    setFocusedOptionIndex(0);\n  }, [onInputChange, opened]);\n\n  useEnhancedEffect(() => {\n    if (!opened) {\n      return;\n    }\n\n    setOptions((prevOptions) => {\n      const nextOptions = transformOptions({\n        value,\n        inputValue,\n        emptyText,\n        creatable,\n        filterFn,\n        options: optionsProp,\n        selectedBehavior,\n      });\n\n      if (isEqual(prevOptions, nextOptions)) {\n        return prevOptions;\n      }\n\n      return nextOptions;\n    });\n  }, [\n    opened,\n    value,\n    inputValue,\n    optionsProp,\n    creatable,\n    selectedBehavior,\n    filterFn,\n  ]);\n\n  return {\n    ...restMultiselectProps,\n\n    // Options props\n    value,\n\n    // Input props\n    inputValue,\n    onInputChange: handleInputChange,\n\n    // States for dropdown\n    options,\n    opened,\n    setOpened,\n    focusedOption,\n    focusedOptionIndex,\n    setFocusedOption,\n    setFocusedOptionIndex,\n  };\n};\n"],"names":["useCallback","useState","isEqual","useEnhancedEffect","defaultFilterFn","transformOptions","DEFAULT_EMPTY_TEXT","DEFAULT_SELECTED_BEHAVIOR","useMultiselectInput","useMultiselect","disabled","value","valueProp","defaultValue","onChange","inputValue","inputValueProp","onInputChange","onInputChangeProp","creatable","emptyText","filterFn","selectedBehavior","options","optionsProp","restMultiselectProps","opened","setOpened","setOptions","focusedOptionIndex","setFocusedOptionIndex","focusedOption","setFocusedOption","handleInputChange","event","prevOptions","nextOptions"],"mappings":"AAAA;;;;AAEA,SAAsBA,WAAW,EAAEC,QAAQ,QAAQ,QAAQ;AAE3D,SAASC,OAAO,QAAQ,4BAAgB;AACxC,SAASC,iBAAiB,QAAQ,sCAA0B;AAG5D,SAASC,eAAe,QAAkB,mBAAmB;AAC7D,SAASC,gBAAgB,QAAQ,6BAA6B;AAC9D,SAASC,kBAAkB,EAAEC,yBAAyB,QAAQ,cAAc;AAC5E,SAASC,mBAAmB,QAAuC,wBAAwB;AAmB3F;;;CAGC,GACD,OAAO,MAAMC,iBAAiB,CAAC,EAC7B,eAAe;AACfC,QAAQ,EAER,gBAAgB;AAChBC,OAAOC,SAAS,EAChBC,YAAY,EACZC,QAAQ,EAER,cAAc;AACdC,YAAYC,iBAAiB,EAAE,EAC/BC,eAAeC,iBAAiB,EAEhC,iBAAiB;AACjBC,YAAY,KAAK,EACjBC,YAAYd,kBAAkB,EAC9Be,WAAWjB,eAAe,EAC1BkB,mBAAmBf,yBAAyB,EAC5CgB,SAASC,cAAc,EAAE,EACL;IACpB,MAAsEhB,uBAAAA,oBAAoB;QACxF,eAAe;QACfG,OAAOC;QACPC;QACAC;QAEA,cAAc;QACdC,YAAYC;QACZC,eAAeC;QAEf,cAAc;QACdR;IACF,IAZM,EAAEC,KAAK,EAAEI,UAAU,EAAEE,aAAa,EAA2B,GAAGT,sBAAzBiB,kDAAyBjB;QAA9DG;QAAOI;QAAYE;;IAc3B,MAAM,CAACS,QAAQC,UAAU,GAAG1B,SAAS;IACrC,MAAM,CAACsB,SAASK,WAAW,GAAG3B,SAA8B,IAC1DyB,SACIrB,iBAAiB;YACjBM;YACAI;YACAK;YACAD;YACAE;YACAE,SAASC;YACTF;QACF,KACE,EAAE;IAGR,MAAM,CAACO,oBAAoBC,sBAAsB,GAAG7B,SAAwB;IAC5E,MAAM,CAAC8B,eAAeC,iBAAiB,GAAG/B,SAAmC;IAE7E,MAAMgC,oBAAoBjC,YAAY,CAACkC;QACrCjB,cAAciB;QAEd,IAAI,CAACR,QAAQ;YACX;QACF;QAEAC,UAAU;QACVG,sBAAsB;IACxB,GAAG;QAACb;QAAeS;KAAO;IAE1BvB,kBAAkB;QAChB,IAAI,CAACuB,QAAQ;YACX;QACF;QAEAE,WAAW,CAACO;YACV,MAAMC,cAAc/B,iBAAiB;gBACnCM;gBACAI;gBACAK;gBACAD;gBACAE;gBACAE,SAASC;gBACTF;YACF;YAEA,IAAIpB,QAAQiC,aAAaC,cAAc;gBACrC,OAAOD;YACT;YAEA,OAAOC;QACT;IACF,GAAG;QACDV;QACAf;QACAI;QACAS;QACAL;QACAG;QACAD;KACD;IAED,OAAO,wCACFI;QAEH,gBAAgB;QAChBd;QAEA,cAAc;QACdI;QACAE,eAAegB;QAEf,sBAAsB;QACtBV;QACAG;QACAC;QACAI;QACAF;QACAG;QACAF;;AAEJ,EAAE"}