{"version":3,"sources":["../../../../src/components/Overlays/Modal/Modal.tsx"],"sourcesContent":["'use client';\n\nimport {\n  forwardRef,\n  ForwardRefExoticComponent,\n  HTMLAttributes,\n  ReactNode,\n  RefAttributes,\n  useEffect,\n  useState,\n} from 'react';\nimport styles from './Modal.module.css';\n\nimport { classNames } from 'helpers/classNames';\nimport { useAppRootContext } from 'hooks/useAppRootContext';\n\nimport { Drawer } from '@xelene/vaul-with-scroll-fix';\n\nimport { ModalClose } from './components/ModalClose/ModalClose';\nimport { ModalHeader } from './components/ModalHeader/ModalHeader';\nimport { ModalOverlay } from './components/ModalOverlay/ModalOverlay';\n\nexport interface ModalProps extends Omit<HTMLAttributes<HTMLDivElement>, 'onAnimationEnd'> {\n  /** Controls the displayed state of the modal, enabling external management. */\n  open?: boolean;\n  /** Callback fired upon state change, facilitating open/close state synchronization. */\n  onOpenChange?: (open: boolean) => void;\n  /** Custom header component to display at the top of the modal. */\n  header?: ReactNode;\n  /** Custom component for the modal's overlay backdrop. */\n  overlayComponent?: ReactNode;\n  /** Component or element used to trigger the modal's visibility. */\n  trigger?: ReactNode;\n  /** Enables nesting within another drawer component, allowing for hierarchical structures. */\n  nested?: boolean;\n  /** Threshold for swipe actions to trigger modal closure, expressed as a decimal between 0 and 1. */\n  closeThreshold?: number;\n  /** Debounce duration after scrolling within the modal before it can be closed through swipe actions. */\n  scrollLockTimeout?: number;\n  /** Governs interaction with background elements when the modal is open. */\n  modal?: boolean;\n  /** Prevents automatic scroll position restoration when the modal closes, preserving user context. */\n  preventScrollRestoration?: boolean;\n  /** Defines snap points for modal positioning, supporting percentages of screen height or pixel values. */\n  snapPoints?: (number | string)[];\n  /** Snap point index at which the overlay begins to fade, enhancing visual cues for modal depth. */\n  fadeFromIndex?: never;\n  /** Determines if the modal can be closed by user interactions */\n  dismissible?: boolean;\n}\n\ntype ModalWithComponents = ForwardRefExoticComponent<ModalProps & RefAttributes<HTMLDivElement>> & {\n  Header: typeof ModalHeader;\n  Overlay: typeof Drawer.Overlay;\n  Close: typeof ModalClose;\n};\n\n/**\n * Modal component, providing a flexible dialog framework with customizable content and interaction models.\n * It leverages the Drawer component from 'vaul' for its base functionality, enhanced with additional properties\n * and behaviors specific to modal dialogues, such as overlay management and nested modals.\n */\nexport const Modal = forwardRef<HTMLDivElement, ModalProps>(({\n  overlayComponent = <ModalOverlay />,\n  open,\n  onOpenChange,\n  header,\n  className,\n  children,\n  nested,\n  trigger,\n  closeThreshold,\n  scrollLockTimeout,\n  snapPoints,\n  fadeFromIndex,\n  modal,\n  preventScrollRestoration,\n  dismissible,\n  ...restProps\n}, ref) => {\n  const container = useAppRootContext();\n  const [portal, setPortal] = useState(container.portalContainer?.current);\n\n  // This is internal optimization for AppRoot\n  // React sets ref to normal value only after the first render\n  // If we will have this logic inside the AppRoot component, then all tree will be re-rendered\n  useEffect(() => {\n    setPortal(container.portalContainer?.current);\n  }, [container.portalContainer]);\n\n  const Component = nested ? Drawer.NestedRoot : Drawer.Root;\n  return (\n    <Component\n      open={open}\n      onOpenChange={onOpenChange}\n      closeThreshold={closeThreshold}\n      scrollLockTimeout={scrollLockTimeout}\n      snapPoints={snapPoints}\n      fadeFromIndex={fadeFromIndex}\n      modal={modal}\n      preventScrollRestoration={preventScrollRestoration}\n      dismissible={dismissible}\n    >\n      {trigger && <Drawer.Trigger asChild>{trigger}</Drawer.Trigger>}\n      <Drawer.Portal container={portal}>\n        {overlayComponent}\n        <Drawer.Content\n          ref={ref}\n          className={classNames(styles.wrapper, className)}\n          {...restProps}\n        >\n          {header}\n          <div className={styles.body}>\n            {children}\n          </div>\n        </Drawer.Content>\n      </Drawer.Portal>\n    </Component>\n  );\n}) as ModalWithComponents;\n\nModal.Header = ModalHeader;\nModal.Overlay = ModalOverlay;\nModal.Close = ModalClose;\n"],"names":["forwardRef","useEffect","useState","classNames","useAppRootContext","Drawer","ModalClose","ModalHeader","ModalOverlay","Modal","ref","overlayComponent","open","onOpenChange","header","className","children","nested","trigger","closeThreshold","scrollLockTimeout","snapPoints","fadeFromIndex","modal","preventScrollRestoration","dismissible","restProps","container","portal","setPortal","portalContainer","current","Component","NestedRoot","Root","Trigger","asChild","Portal","Content","div","Header","Overlay","Close"],"mappings":"AAAA;;;;;AAEA,SACEA,UAAU,EAKVC,SAAS,EACTC,QAAQ,QACH,QAAQ;AAGf,SAASC,UAAU,QAAQ,8BAAqB;AAChD,SAASC,iBAAiB,QAAQ,mCAA0B;AAE5D,SAASC,MAAM,QAAQ,+BAA+B;AAEtD,SAASC,UAAU,QAAQ,qCAAqC;AAChE,SAASC,WAAW,QAAQ,uCAAuC;AACnE,SAASC,YAAY,QAAQ,yCAAyC;AAqCtE;;;;CAIC,GACD,OAAO,MAAMC,sBAAQT,WAAuC,SAiBzDU;QAjB0D,EAC3DC,iCAAmB,KAACH,iBAAe,EACnCI,IAAI,EACJC,YAAY,EACZC,MAAM,EACNC,SAAS,EACTC,QAAQ,EACRC,MAAM,EACNC,OAAO,EACPC,cAAc,EACdC,iBAAiB,EACjBC,UAAU,EACVC,aAAa,EACbC,KAAK,EACLC,wBAAwB,EACxBC,WAAW,EAEZ,WADIC;QAfHf;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;;QAIqCE;IADrC,MAAMA,YAAYvB;IAClB,MAAM,CAACwB,QAAQC,UAAU,GAAG3B,UAASyB,6BAAAA,UAAUG,eAAe,cAAzBH,iDAAAA,2BAA2BI,OAAO;IAEvE,4CAA4C;IAC5C,6DAA6D;IAC7D,6FAA6F;IAC7F9B,UAAU;YACE0B;QAAVE,WAAUF,6BAAAA,UAAUG,eAAe,cAAzBH,iDAAAA,2BAA2BI,OAAO;IAC9C,GAAG;QAACJ,UAAUG,eAAe;KAAC;IAE9B,MAAME,YAAYf,SAASZ,OAAO4B,UAAU,GAAG5B,OAAO6B,IAAI;IAC1D,qBACE,MAACF;QACCpB,MAAMA;QACNC,cAAcA;QACdM,gBAAgBA;QAChBC,mBAAmBA;QACnBC,YAAYA;QACZC,eAAeA;QACfC,OAAOA;QACPC,0BAA0BA;QAC1BC,aAAaA;;YAEZP,yBAAW,KAACb,OAAO8B,OAAO;gBAACC,OAAO;0BAAElB;;0BACrC,MAACb,OAAOgC,MAAM;gBAACV,WAAWC;;oBACvBjB;kCACD,MAACN,OAAOiC,OAAO;wBACb5B,KAAKA;wBACLK,WAAWZ,oCAA2BY;uBAClCW;;4BAEHZ;0CACD,KAACyB;gCAAIxB,SAAS;0CACXC;;;;;;;;AAMb,GAA0B;AAE1BP,MAAM+B,MAAM,GAAGjC;AACfE,MAAMgC,OAAO,GAAGjC;AAChBC,MAAMiC,KAAK,GAAGpC"}