{"version":3,"sources":["../../../../../../../src/components/Form/Multiselect/components/MultiselectDropdown/MultiselectDropdown.tsx"],"sourcesContent":["import { forwardRef, ForwardRefExoticComponent, Fragment, MouseEvent, RefAttributes, RefObject } from 'react';\nimport styles from './MultiselectDropdown.module.css';\n\nimport { Cell, CellProps } from 'components/Blocks/Cell/Cell';\nimport { MultiselectOption } from 'components/Form/Multiselect/types';\nimport { Popper } from 'components/Overlays/Popper/Popper';\nimport { isCreateNewOptionPreset, isEmptyOptionPreset } from '../../hooks/constants';\nimport { UseMultiselectProps } from '../../hooks/useMultiselect';\nimport { renderOptionDefault } from './constants';\n\nexport interface MultiselectDropdownProps extends Required<Pick<UseMultiselectProps, 'options' | 'value'>> {\n  /** Array of selected options. */\n  value: MultiselectOption[];\n  /** Reference to the target element the dropdown is associated with. */\n  targetRef: RefObject<HTMLElement>;\n  /** Accessibility ID for the dropdown. */\n  dropdownAriaId: string;\n  /** Currently focused option within the dropdown. */\n  focusedOption: MultiselectOption | null;\n  /** Function to register a DOM node with an option index. */\n  setOptionNode: (index: number, node: HTMLElement) => void;\n  /** Function to control the open state of the dropdown. */\n  setOpened: (opened: boolean) => void;\n  /** Index of the currently focused option. */\n  focusedOptionIndex: number | null;\n  /** Function to update the index of the focused option. */\n  setFocusedOptionIndex: (index: number) => void;\n  /** Function to add an option derived from the input value. */\n  addOptionFromInput: () => void;\n  /** Mouse leave event handler for the dropdown. */\n  onMouseLeave: (event: MouseEvent<HTMLDivElement>) => void;\n  /** Function to add a selected option. */\n  addOption: (option: MultiselectOption) => void;\n  /** Function to clear the input value. */\n  clearInput: () => void;\n  /** Custom render function for each option. Defaults to a basic implementation. */\n  renderOption?: ForwardRefExoticComponent<CellProps & RefAttributes<unknown>>;\n  /** Whether to close the dropdown after selecting an option. */\n  closeDropdownAfterSelect?: boolean;\n}\n\n/**\n * Renders the dropdown menu for the multiselect input, including all options and managing interactions such as selection, focus, and mouse events.\n * Utilizes the `Popper` component for positioning relative to the input field.\n */\nexport const MultiselectDropdown = forwardRef<HTMLDivElement, MultiselectDropdownProps>(({\n  dropdownAriaId,\n  options,\n  onMouseLeave,\n  targetRef,\n  addOptionFromInput,\n  setFocusedOptionIndex,\n  renderOption = renderOptionDefault,\n  focusedOption,\n  value,\n  setOptionNode,\n  setOpened,\n  closeDropdownAfterSelect,\n  addOption,\n  focusedOptionIndex,\n  clearInput,\n}, ref) => {\n\n  return (\n    <Popper\n      id={dropdownAriaId}\n      ref={ref}\n      targetRef={targetRef}\n      onMouseLeave={onMouseLeave}\n      autoUpdateOnTargetResize\n      role=\"listbox\"\n      placement=\"bottom\"\n      sameWidth\n      className={styles.wrapper}\n    >\n      {options.map((option, index) => {\n        if (isEmptyOptionPreset(option)) {\n          return (\n            <Cell key=\"empty\" readOnly className={styles.empty}>\n              {option.placeholder}\n            </Cell>\n          );\n        }\n\n        if (isCreateNewOptionPreset(option)) {\n          return (\n            <Cell\n              key=\"new-options\"\n              hovered={focusedOptionIndex === index}\n              onMouseDown={addOptionFromInput}\n              onMouseEnter={() => setFocusedOptionIndex(index)}\n            >\n              {option.actionText}\n            </Cell>\n          );\n        }\n\n        return (\n          <Fragment key={`${typeof option.value}-${option.label}`}>\n            {renderOption(\n              {\n                className: styles.option,\n                hovered: focusedOption\n                  ? option.value === focusedOption.value\n                  : false,\n                children: option.label,\n                selected: value.findIndex((selectedOption) => selectedOption.value === option.value) !== -1,\n                ref: (node: HTMLElement) => setOptionNode(index, node),\n                onMouseDown: (event: MouseEvent<HTMLDivElement>) => {\n                  if (event.defaultPrevented) {\n                    return;\n                  }\n\n                  closeDropdownAfterSelect && setOpened(false);\n                  addOption(option);\n                  clearInput();\n                },\n                onMouseEnter: () => setFocusedOptionIndex(index),\n              },\n            )}\n          </Fragment>\n        );\n      })}\n    </Popper>\n  );\n});\n"],"names":["MultiselectDropdown","forwardRef","dropdownAriaId","options","onMouseLeave","targetRef","addOptionFromInput","setFocusedOptionIndex","renderOption","renderOptionDefault","focusedOption","value","setOptionNode","setOpened","closeDropdownAfterSelect","addOption","focusedOptionIndex","clearInput","ref","Popper","id","autoUpdateOnTargetResize","role","placement","sameWidth","className","map","option","index","isEmptyOptionPreset","Cell","readOnly","placeholder","isCreateNewOptionPreset","hovered","onMouseDown","onMouseEnter","actionText","Fragment","children","label","selected","findIndex","selectedOption","node","event","defaultPrevented"],"mappings":";;;;+BA6CaA;;;eAAAA;;;;uBA7CyF;sBAGtE;wBAET;2BACsC;4BAEzB;AAqC7B,MAAMA,oCAAsBC,IAAAA,iBAAU,EAA2C,CAAC,EACvFC,cAAc,EACdC,OAAO,EACPC,YAAY,EACZC,SAAS,EACTC,kBAAkB,EAClBC,qBAAqB,EACrBC,eAAeC,+BAAmB,EAClCC,aAAa,EACbC,KAAK,EACLC,aAAa,EACbC,SAAS,EACTC,wBAAwB,EACxBC,SAAS,EACTC,kBAAkB,EAClBC,UAAU,EACX,EAAEC;IAED,qBACE,qBAACC,cAAM;QACLC,IAAIlB;QACJgB,KAAKA;QACLb,WAAWA;QACXD,cAAcA;QACdiB,wBAAwB;QACxBC,MAAK;QACLC,WAAU;QACVC,SAAS;QACTC,SAAS;kBAERtB,QAAQuB,GAAG,CAAC,CAACC,QAAQC;YACpB,IAAIC,IAAAA,8BAAmB,EAACF,SAAS;gBAC/B,qBACE,qBAACG,UAAI;oBAAaC,QAAQ;oBAACN,SAAS;8BACjCE,OAAOK,WAAW;mBADX;YAId;YAEA,IAAIC,IAAAA,kCAAuB,EAACN,SAAS;gBACnC,qBACE,qBAACG,UAAI;oBAEHI,SAASlB,uBAAuBY;oBAChCO,aAAa7B;oBACb8B,cAAc,IAAM7B,sBAAsBqB;8BAEzCD,OAAOU,UAAU;mBALd;YAQV;YAEA,qBACE,qBAACC,eAAQ;0BACN9B,aACC;oBACEiB,SAAS;oBACTS,SAASxB,gBACLiB,OAAOhB,KAAK,KAAKD,cAAcC,KAAK,GACpC;oBACJ4B,UAAUZ,OAAOa,KAAK;oBACtBC,UAAU9B,MAAM+B,SAAS,CAAC,CAACC,iBAAmBA,eAAehC,KAAK,KAAKgB,OAAOhB,KAAK,MAAM,CAAC;oBAC1FO,KAAK,CAAC0B,OAAsBhC,cAAcgB,OAAOgB;oBACjDT,aAAa,CAACU;wBACZ,IAAIA,MAAMC,gBAAgB,EAAE;4BAC1B;wBACF;wBAEAhC,4BAA4BD,UAAU;wBACtCE,UAAUY;wBACVV;oBACF;oBACAmB,cAAc,IAAM7B,sBAAsBqB;gBAC5C;eApBW,CAAC,EAAE,OAAOD,OAAOhB,KAAK,CAAC,CAAC,EAAEgB,OAAOa,KAAK,CAAC,CAAC;QAwB3D;;AAGN"}